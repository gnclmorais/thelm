<!DOCTYPE HTML>
<html>
<head>
  <meta charset="UTF-8">
  <title>Thelm</title>
</head>

<body>
	<div id="app"></div>

	<script src="app.js"></script>
	<script>
		var storageKey = 'post-app-save';
		var storedState = localStorage.getItem(storageKey);
		console.log("Retrieved state: ", storedState);
		var startingState = storedState ? JSON.parse(storedState) : null;

		var appContainer = document.getElementById('app');
		var app = Elm.Main.init({
			node: appContainer,
			flags: startingState,
		});

		app.ports.storeReferences.subscribe(function (references) {
			if (references.length === 0) return;

			var referencesJson = JSON.stringify(references);
			localStorage.setItem(storageKey, referencesJson);
			console.log('Saved state: ', referencesJson);
		});
	</script>
</body>
</html>
